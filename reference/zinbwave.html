<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform dimensionality reduction using a ZINB regression model with
gene and cell-level covariates. — zinbwave • zinbwave</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform dimensionality reduction using a ZINB regression model with
gene and cell-level covariates. — zinbwave" />
<meta property="og:description" content="Given an object with the data, it performs dimensionality reduction using
a ZINB regression model with gene and cell-level covariates." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zinbwave</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.11.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro.html">An introduction to ZINB-WaVE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/drisso/zinbwave/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform dimensionality reduction using a ZINB regression model with
gene and cell-level covariates.</h1>
    <small class="dont-index">Source: <a href='https://github.com/drisso/zinbwave/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/drisso/zinbwave/blob/master/R/zinbwave.R'><code>R/zinbwave.R</code></a></small>
    <div class="hidden name"><code>zinbwave.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given an object with the data, it performs dimensionality reduction using
a ZINB regression model with gene and cell-level covariates.</p>
    </div>

    <pre class="usage"><span class='fu'>zinbwave</span>(<span class='kw'>Y</span>, <span class='kw'>...</span>)

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>zinbwave</span>(
  <span class='kw'>Y</span>,
  <span class='kw'>X</span>,
  <span class='kw'>V</span>,
  K = <span class='fl'>2</span>,
  <span class='kw'>fitted_model</span>,
  <span class='kw'>which_assay</span>,
  <span class='kw'>which_genes</span>,
  commondispersion = <span class='fl'>TRUE</span>,
  zeroinflation = <span class='fl'>TRUE</span>,
  verbose = <span class='fl'>FALSE</span>,
  nb.repeat.initialize = <span class='fl'>2</span>,
  maxiter.optimize = <span class='fl'>25</span>,
  stop.epsilon.optimize = <span class='fl'>1e-04</span>,
  BPPARAM = <span class='kw'>BiocParallel</span>::<span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/register.html'>bpparam</a></span>(),
  normalizedValues = <span class='fl'>FALSE</span>,
  residuals = <span class='fl'>FALSE</span>,
  imputedValues = <span class='fl'>FALSE</span>,
  observationalWeights = <span class='fl'>FALSE</span>,
  <span class='kw'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>The data (genes in rows, samples in columns). Currently implemented
only for <code>SummarizedExperiment</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to describe the model, see
<code>zinbModel</code>.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>The design matrix containing sample-level covariates, one sample per
row. If missing, X will contain only an intercept. If Y is a
SummarizedExperiment object, X can be a formula using the variables in the
colData slot of Y.</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>The design matrix containing gene-level covariates, one gene
per row. If missing, V will contain only an intercept. If Y is a
SummarizedExperiment object, V can be a formula using the variables in the
rowData slot of Y.</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>integer. Number of latent factors. Specify <code>K = 0</code> if only
computing observational weights.</p></td>
    </tr>
    <tr>
      <th>fitted_model</th>
      <td><p>a <code>ZinbModel</code> object.</p></td>
    </tr>
    <tr>
      <th>which_assay</th>
      <td><p>numeric or character. Which assay of Y to use. If missing,
if `assayNames(Y)` contains "counts" then that is used. Otherwise, the
first assay is used.</p></td>
    </tr>
    <tr>
      <th>which_genes</th>
      <td><p>character. Which genes to use to estimate W (see details).
Ignored if <code>fitted_model</code> is provided.</p></td>
    </tr>
    <tr>
      <th>commondispersion</th>
      <td><p>Whether or not a single dispersion for all features
is estimated (default TRUE).</p></td>
    </tr>
    <tr>
      <th>zeroinflation</th>
      <td><p>Whether or not a ZINB model should be fitted. If FALSE,
a negative binomial model is fitted instead.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Print helpful messages.</p></td>
    </tr>
    <tr>
      <th>nb.repeat.initialize</th>
      <td><p>Number of iterations for the initialization of
beta_mu and gamma_mu.</p></td>
    </tr>
    <tr>
      <th>maxiter.optimize</th>
      <td><p>maximum number of iterations for the optimization
step (default 25).</p></td>
    </tr>
    <tr>
      <th>stop.epsilon.optimize</th>
      <td><p>stopping criterion in the optimization step,
when the relative gain in likelihood is below epsilon (default 0.0001).</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>object of class <code>bpparamClass</code> that specifies the
back-end to be used for computations. See
<code><a href='https://rdrr.io/pkg/BiocParallel/man/register.html'>bpparam</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>normalizedValues</th>
      <td><p>indicates wether or not you want to compute
normalized values for the counts after adjusting for gene and cell-level
covariates.</p></td>
    </tr>
    <tr>
      <th>residuals</th>
      <td><p>indicates wether or not you want to compute the residuals
of the ZINB model. Deviance residuals are computed.</p></td>
    </tr>
    <tr>
      <th>imputedValues</th>
      <td><p>indicates wether or not you want to compute the imputed
counts of the ZINB model.</p></td>
    </tr>
    <tr>
      <th>observationalWeights</th>
      <td><p>indicates whether to compute the observational
weights for differential expression (see vignette).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>SingleCellExperiment</code>; the dimensionality
  reduced matrix is stored in the <code>reducedDims</code> slot and optionally
  normalized values and residuals are added in the list of assays.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For visualization (heatmaps, ...), please use the normalized values.
It corresponds to the deviance residuals when the <code>W</code> is not included
in the model but the gene and cell-level covariates are. As a results, when
<code>W</code> is not included in the model, the deviance residuals should capture
the biology. Note that we do not recommend to use the normalized values for
any downstream analysis (such as clustering, or differential expression), but
only for visualization.</p>
<p>If one has already fitted a model using <code>ZinbModel</code>,
the object containing such model can be used as input of <code>zinbwave</code> to
save the resulting W into a <code>SummarizedExperiment</code> and optionally
compute residuals and normalized values, without the need for re-fitting the
model.</p>
<p>By default <code>zinbwave</code> uses all genes to estimate <code>W</code>.
  However, we recommend to use the top 1,000 most variable genes for this
  step. In general, a user can specify any custom set of genes to be used to
  estimate <code>W</code>, by specifying either a vector of gene names, or a single
  character string corresponding to a column of the <code>rowData</code>.</p>
<p>Note that if both <code>which_genes</code> is specified and at least one
  among <code>observationalWeights</code>, <code>imputedValues</code>, <code>residuals</code>,
  and <code>normalizedValues</code> is <code>TRUE</code>, the model needs to be fit
  twice.</p>
    <h2 class="hasAnchor" id="methods-by-class-"><a class="anchor" href="#methods-by-class-"></a>Methods (by class)</h2>

    
<ul>
<li><p><code>SummarizedExperiment</code>: Y is a
<code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html'>SummarizedExperiment</a></code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>se</span> <span class='op'>&lt;-</span> <span class='fu'>SummarizedExperiment</span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span>(<span class='fl'>60</span>, lambda=<span class='fl'>5</span>), nrow=<span class='fl'>10</span>, ncol=<span class='fl'>6</span>),
                           colData = <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(bio = <span class='fu'><a href='https://rdrr.io/r/base/gl.html'>gl</a></span>(<span class='fl'>2</span>, <span class='fl'>3</span>)))

<span class='kw'>m</span> <span class='op'>&lt;-</span> <span class='fu'>zinbwave</span>(<span class='kw'>se</span>, X=<span class='st'>"~bio"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: No assay named `counts`, using first assay.Use `assay` to specify a different assay.</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Davide Risso, Svetlana Gribkova, Fanny Perraudeau, Jean-Philippe Vert, Clara Bagatin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


